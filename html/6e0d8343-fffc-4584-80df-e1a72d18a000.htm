<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>KotakNet RTD</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="6e0d8343-fffc-4584-80df-e1a72d18a000" /><meta name="Description" content="One of the cool features of KotakNet is, it supports RTD server. Now you can get streaming real-time quotes in Excel." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="true" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">KotakNet DotNet Library<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html\c6a78a91-b3e6-4aba-a817-af302a7b5677.htm" title="KotakNet DotNet Library" tocid="roottoc">KotakNet DotNet Library</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/c6a78a91-b3e6-4aba-a817-af302a7b5677.htm" title="Getting Started" tocid="c6a78a91-b3e6-4aba-a817-af302a7b5677">Getting Started</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/66c5330f-9e11-40fb-9682-c1aa570472de.htm" title="Introduction" tocid="66c5330f-9e11-40fb-9682-c1aa570472de">Introduction</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/9e0e38c6-2323-41c0-8c3f-cda9fe0e47b7.htm" title="KotakNet Core" tocid="9e0e38c6-2323-41c0-8c3f-cda9fe0e47b7">KotakNet Core</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/c01fdbc6-79b6-42f0-93ad-cb9919673b1e.htm" title="KotakNet Bridge" tocid="c01fdbc6-79b6-42f0-93ad-cb9919673b1e">KotakNet Bridge</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/6e0d8343-fffc-4584-80df-e1a72d18a000.htm" title="KotakNet RTD" tocid="6e0d8343-fffc-4584-80df-e1a72d18a000">KotakNet RTD</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/5ef387d9-37da-4689-9845-232501ce4fd7.htm" title="Static Variables" tocid="5ef387d9-37da-4689-9845-232501ce4fd7">Static Variables</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/d11ff4b0-d5e9-4264-b314-e14a947cea8e.htm" title="Folders and Files" tocid="d11ff4b0-d5e9-4264-b314-e14a947cea8e">Folders and Files</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/e0774a72-9e12-44e8-9309-364604e9a2f9.htm" title="Privacy and Security" tocid="e0774a72-9e12-44e8-9309-364604e9a2f9">Privacy and Security</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/9006b4ff-44bd-4456-b99e-f36377253f30.htm" title="Best Pratices" tocid="9006b4ff-44bd-4456-b99e-f36377253f30">Best Pratices</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/86925bbc-d593-40b9-809d-924f1135cd77.htm" title="Troubleshooting" tocid="86925bbc-d593-40b9-809d-924f1135cd77">Troubleshooting</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/d850eeaf-dede-417b-8bcd-9905a540465a.htm" title="Resources" tocid="d850eeaf-dede-417b-8bcd-9905a540465a">Resources</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>KotakNet RTD</h1></td></tr></table><span class="introStyle">KotakNet DotNet Library<br /> <br /></span> <div class="introduction"><p>One of the cool features of KotakNet is, it supports RTD server. Now you can get streaming real-time quotes in Excel.</p><p>RTD server gets data from Websocket, parses the received data and streams real time quotes to Excel.</p><p>The Syntax for Excel RTD Function is =RTD(ProgID,ServerName,Topic1,[Topic2])</p><ul><li><p>ProgID: KotakNet.Rtd</p></li><li><p>ServerName: Blank</p></li><li><p>Topic1 - Ticker in the Format of [TRADESYMBOL].[EXCH] Ex: AXISBANK.NSE, NIFTY22FEB18FUT.NFO, SILVERM22FEB28FUT.MCX</p></li><li><p>Topic2 - Price Filed. </p></li></ul><p><strong>Supported Price Fields</strong></p><p><span class="command">"LAST", "PCTCHG", "NETCHG", "LASTSIZE", "BID", "BIDSIZE", "ASK", "ASKSIZE", "AVGPRICE", "VOLUME", "TOTALBUYQTY", "TOTALSELLQTY", "OPEN", "HIGH", "LOW", "CLOSE", "OI", "LTT", "LOWERCKT", "UPPERCKT", "MTM", "NETQTY", "AVGBOUGHTPRICE", "AVGSOLDPRICE", "BOUGHTQTY", "SOLDQTY", "PING"</span></p><p><strong>Example:</strong></p><p><span class="code">=RTD("KotakNet.Rtd",,"AXISBANK.NSE","LAST")</span></p><p><span class="code">=RTD("KotakNet.Rtd",,"AXISBANK.NSE","OPEN")</span></p><p>Adding RTD formula likes above in every cell is tedious, so we added a UDF "GetRTD" in the sample excel sheet, which will wrap the complex RTD function. User can use this UDF instead of the original RTD function, note this is not mandatory.
</p><p>The syntax for the GetRTD is </p><p><span class="code">=GetRTD(Exch, TrdSymbol, Field)</span></p><p><span class="code">=GetRTD("NSE", "AXISBANK", "LAST")</span> ‘ will get LTP</p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EAEDAAA_tab1" class="codeSnippetContainerTabSingle">VB</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAEDAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAEDAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAEDAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">Public</span> <span class="highlight-keyword">Function</span> GetRTD(<span class="highlight-keyword">ByVal</span> Exch <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span>, <span class="highlight-keyword">ByVal</span> Trdsym <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span>, <span class="highlight-keyword">ByVal</span> field <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span>) <span class="highlight-keyword">As</span> Variant
    <span class="highlight-keyword">If</span> (Exch = vbNullString <span class="highlight-keyword">Or</span> Trdsym = vbNullString <span class="highlight-keyword">Or</span> field = vbNullString) <span class="highlight-keyword">Then</span> GetRTD = <span class="highlight-number">0</span>: <span class="highlight-keyword">Exit</span> <span class="highlight-keyword">Function</span>
    Exch = UCase(Exch)
    Trdsym = UCase(Trdsym)
    field = UCase(field)
    <span class="highlight-keyword">Dim</span> Prfx <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span>
    Prfx = Trdsym &amp; <span class="highlight-literal">"."</span> &amp; Exch
    GetRTD = WorksheetFunction.RTD(<span class="highlight-literal">"KotakNet.Rtd"</span>, <span class="highlight-literal">""</span>, Prfx, field)
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Function</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAEDAAA");</script><p><strong>Subscribe Quotes:</strong></p><p>To get Real-time quotes in <span class="code">"Excel RTD"</span>, you must be logged-in to KotakNet and need to call the <span class="code">"SubscribeQuotes"</span> method for the Symbol which you want data. This is equivalent to adding symbols in market watch of trading platform. 
</p><p><span class="code">=SubscribeQuotes(Exch, TrdSymbol)</span></p><p><span class="code">=SubscribeQuotes("NSE", "AXISBANK")</span></p></div><div class="collapsibleAreaRegion" id="Section1"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />RTD Throttle Interval</span></div><div id="ID1RBSection" class="collapsibleSection"><p><strong>Changing RTD throttle interval:</strong></p><p>By default, Excel will request real time data from RTD server at an interval of 2 seconds. Who wants to lag behind by 2 seconds in the stock markets where the prices are changing in micro seconds?
</p><p>We will change the throttle interval to 0, so that Excel will update quotes in real time.
</p><p><strong>To Change RTD Interval:</strong></p><ul><li><p>In Excel, go to the Visual Basic Editor by pressing <span class="code">ALT+F11</span></p></li><li><p>Once you are in Visual Basic Editor, Press <span class="code">CTRL+G</span> to open Immediate Window </p></li><li><p>Once you are in Immediate Window, Type the below command and Press enter </p></li><li><p><span class="code">Application.RTD.ThrottleInterval = 0</span></p></li></ul><p><strong>To Check whether the interval is updated or not:</strong></p><ul><li><p>Type the below command in Immediate Window and Press enter </p></li><li><p><span class="code">? Application.RTD.ThrottleInterval</span></p></li><li><p>The above command will return 0; if not 0 again set the interval as mentioned above</p></li></ul></div><div class="collapsibleAreaRegion" id="Section2"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />RTD Troubleshooting</span></div><div id="ID2RBSection" class="collapsibleSection"><p>Most issues will be user or system specific</p><p>Common reasons for RTD issues</p><ul><li><p>Excel not run with Admin rights</p></li><li><p>Firewall issues</p></li><li><p>Antivirus blocking and deleting files</p></li><li><p>Corrupt RTD Registry (Due to multiple install/uninstall of software’s that have RTD feature like NestTrader etc)</p></li><li><p>Corrupt Excel Registry (Due to Multiple versions installation of MS Office)</p></li><li><p>RTD Port is used by any other application</p></li></ul><p>The below steps may resolve the RTD issue</p><ul><li><p>Add KotakNet to your Antivirus Exclusion List</p></li><li><p>Enable Firewall for RTD port</p></li><li><p>Re-install KotakNet</p></li><li><p>Repair MS office</p></li></ul></div><div class="alert"><table><tr><th><img src="../icons/AlertCaution.png" alt="Caution note" /> Caution</th></tr><tr><td><p>Do not download macro enabled excel files from untrusted sources. Macro enabled excel files are used to spread viruses and trojans. If need to download, then scan the downloaded file with your Anti virus</p></td></tr></table></div></div></div><div id="pageFooter" class="pageFooter">Document created with <a href="https://github.com/EWSoftware/SHFB">Sandcastle Help File Builder!</a><br /><p><a href="https://howutrade.in" target="_blank">Ⓒ 2022 Howutrade Software Solutions LLP</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:feedback%40howutrade.in?Subject=KotakNet DotNet Library">Howutrade</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></body></html>